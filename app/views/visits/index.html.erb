<div class="row mb-3">
  <div class="col-md-12">
    <h1>
      List of all visits
    </h1>
  </div>
</div>

<hr>

<div class="row mb-3">
  <div class="col-md-8 offset-md-2">
    <h2>
      Add a new visit
    </h2>

    <form action="/insert_visit" method="post">
      <div class="form-group">
        <label for="purpose_box">
          Purpose
        </label>

        <select name="purpose_from_query" id="purpose_box" class="form-control form-control-sm mr-sm-1" value="Choose a purpose...">
        <option value="DO NOT BOTHER ME!!">Studying Alone and Only Studying</option>
        <option value="Studying, but Down to Study Together">Studying, but Down to Study Together</option>
        <option value="Kinda Studying but down to Procrastinate">Kinda Studying but down to Procrastinate</option>
        <option value="I need friends. Come hang out with me!">I need friends. Come hang out with me!</option></select>
      </div>

      <div class="form-group">
        <input type="hidden" id="visitors_id_box" name="visitors_id_from_query" class="form-control" placeholder="<%= session[:user_id] %>">
      </div>

      <div class="form-group">
        <label for="location_id_box">
          Location
        </label>
        <select name="location_id_from_query" id="location_id_box" class="form-control form-control-sm mr-sm-1" value="Choose a purpose...">
        <% Location.all.order({:name => :asc}).each do |locations| %>
        <option value="<%= locations.name %>"><%= locations.name %></option>
        <% end %>
        </select>
      </div>

      <button class="btn btn-block btn-outline-secondary">
        Create visit
      </button>
    </form>
  </div>
</div>

<hr>
<div class="row mb-3">
  <div class="col-md-12">
    <table class="table">
      <tr>
        <th>
          ID
        </th>

        <th>
          Purpose
        </th>

        <th>
          Visitors
        </th>

        <th>
          Location
        </th>

        <th>
          Checked In
        </th>

        <th>
          Checked Out
        </th>

        <th>
        </th>
      </tr>

      <% @visits.each do |visit| %>
      <tr>
        <td>
          <%= visit.id %>
        </td>

        <td>
          <%= visit.purpose %>
        </td>

        <td>
          <%= User.where({:id => visit.visitors_id}).pluck(:username).at(0) %>
        </td>

        <td>
          <%= Location.where({:id => visit.location_id}).pluck(:name).at(0) %>
        </td>

        <td>
          <%= time_ago_in_words(visit.created_at) %> ago
        </td>
        <td>
          <%= time_ago_in_words(visit.updated_at) %> ago
        </td>

        <td>
          <a href="/visits/<%= visit.id %>">
            Show details
          </a>
        </td>
      </tr>
      <% end %>
    </table>
  </div>
</div>

<hr>
